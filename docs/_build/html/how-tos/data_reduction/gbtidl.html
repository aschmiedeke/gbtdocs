
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>How to process spectra using GBTIDL (examples) &#8212; GBT Docs 0.1 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b76e3c8a" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/tabs.css?v=4c969af8" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/tooltipster.custom.css?v=7bc2f056" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/tooltipster.bundle.min.css?v=37217874" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/tooltipster-sideTip-shadow.min.css?v=6227e517" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/tooltipster-sideTip-punk.min.css?v=94669e23" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/tooltipster-sideTip-noir.min.css?v=21a39f42" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/tooltipster-sideTip-light.min.css?v=a18b2449" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/tooltipster-sideTip-borderless.min.css?v=dbff53e4" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/micromodal.css?v=d7bf34ee" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css?v=04af0cc0" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=e1a75a79"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/tabs.js?v=3ee01567"></script>
    <script src="../../_static/js/hoverxref.js?v=c9b52ebc"></script>
    <script src="../../_static/js/tooltipster.bundle.min.js?v=18bf091b"></script>
    <script src="../../_static/js/micromodal.min.js?v=04d6302d"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script src="../../_static/design-tabs.js?v=36754332"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'how-tos/data_reduction/gbtidl';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="How to account for sky opacity in GBT Observations" href="calculate_opacity.html" />
    <link rel="prev" title="MUSTANG-2 Deliverables" href="../receivers/mustang2/data/mustang2_deliverables.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/GBO-vertical-PGGradient.svg" class="logo__image only-light" alt="GBT Docs 0.1 documentation - Home"/>
    <script>document.write(`<img src="../../_static/GBO-vertical-PGGradient.svg" class="logo__image only-dark" alt="GBT Docs 0.1 documentation - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../tutorials/index.html"><svg aria-hidden="true" class="sd-octicon sd-octicon-mortar-board orange" height="2.0em" version="1.1" viewbox="0 0 24 24" width="2.0em"><path d="M12.292 2.06a.75.75 0 00-.584 0L.458 6.81a.75.75 0 000 1.38L4.25 9.793v3.803a2.901 2.901 0 00-1.327.757c-.579.58-.923 1.41-.923 2.43v4.5c0 .248.128.486.335.624.06.04.117.073.22.124.124.062.297.138.52.213.448.149 1.09.288 1.925.288s1.477-.14 1.925-.288c.223-.075.396-.15.52-.213a2.11 2.11 0 00.21-.117A.762.762 0 008 21.28v-4.5c0-1.018-.344-1.85-.923-2.428a2.9 2.9 0 00-1.327-.758v-3.17l5.958 2.516a.75.75 0 00.584 0l5.208-2.2v4.003a2.552 2.552 0 01-.079.085 4.057 4.057 0 01-.849.65c-.826.488-2.255 1.021-4.572 1.021-.612 0-1.162-.037-1.654-.1a.75.75 0 00-.192 1.487c.56.072 1.173.113 1.846.113 2.558 0 4.254-.592 5.334-1.23.538-.316.914-.64 1.163-.896a2.84 2.84 0 00.392-.482h.001A.75.75 0 0019 15v-4.892l4.542-1.917a.75.75 0 000-1.382l-11.25-4.75zM5 15c-.377 0-.745.141-1.017.413-.265.265-.483.7-.483 1.368v4.022c.299.105.797.228 1.5.228s1.201-.123 1.5-.228V16.78c0-.669-.218-1.103-.483-1.368A1.431 1.431 0 005 15zm7-3.564L2.678 7.5 12 3.564 21.322 7.5 12 11.436z" fill-rule="evenodd"></path></svg> Tutorials</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/hi_psw_tutorial.html">HI Position Switched (psw) Spectrum</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/kfpa_nh3_mapping_tutorial.html">NH<sub>3</sub> Mapping Observations with the K-Band Focal Plane Array (KFPA) on the GBT</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../index.html"><svg aria-hidden="true" class="sd-octicon sd-octicon-terminal green" height="2.0em" version="1.1" viewbox="0 0 24 24" width="2.0em"><path d="M9.25 12a.75.75 0 01-.22.53l-2.75 2.75a.75.75 0 01-1.06-1.06L7.44 12 5.22 9.78a.75.75 0 111.06-1.06l2.75 2.75c.141.14.22.331.22.53zm2 2a.75.75 0 000 1.5h5a.75.75 0 000-1.5h-5z"></path><path d="M0 4.75C0 3.784.784 3 1.75 3h20.5c.966 0 1.75.784 1.75 1.75v14.5A1.75 1.75 0 0122.25 21H1.75A1.75 1.75 0 010 19.25V4.75zm1.75-.25a.25.25 0 00-.25.25v14.5c0 .138.112.25.25.25h20.5a.25.25 0 00.25-.25V4.75a.25.25 0 00-.25-.25H1.75z" fill-rule="evenodd"></path></svg> How-To Guides</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../infrastructure/remote-connection.html">How to connect remotely to the GBO network</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general_guides/gbt_observing.html">GBT observations 101</a></li>
<li class="toctree-l2"><a class="reference internal" href="../observing_modes/C-band_Mueller_matrix.html">How to derive a Mueller matrix</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../observing_modes/pulsars.html">Pulsar observing How-To Guides</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../observing_modes/pulsars/pulsar_time_obs.html">Timing Observations of a Known Pulsar</a></li>
<li class="toctree-l3"><a class="reference internal" href="../observing_modes/pulsars/pulsar_flux_cal.html">Pulsar-Mode Flux Calibration Observations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../observing_modes/pulsars/pulsar_search.html">Pulsar Search Observations</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../receivers/argus/argus_obs.html">How to observe using Argus</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../receivers/mustang2.html">MUSTANG-2 How-To Guides</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../receivers/mustang2/mustang2_proposal.html">How to Propose with MUSTANG-2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../receivers/mustang2/mustang2_calc_obs_time.html">How to Calculate Observing Time Required for MUSTANG-2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../receivers/mustang2/mustang2_obs_scripts.html">How to Prepare MUSTANG-2 Observing Scripts</a></li>
<li class="toctree-l3"><a class="reference internal" href="../receivers/mustang2/mustang2_setup.html">How to setup MUSTANG-2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../receivers/mustang2/mustang2_obs.html">How to observe with MUSTANG-2</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../receivers/mustang2/mustang2_data.html">MUSTANG-2 data</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../receivers/mustang2/data/mustang2_deliverables.html">MUSTANG-2 Deliverables</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">How to process spectra using GBTIDL (examples)</a></li>
<li class="toctree-l2"><a class="reference internal" href="calculate_opacity.html">How to account for sky opacity in GBT Observations</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../explanations/index.html"><svg aria-hidden="true" class="sd-octicon sd-octicon-repo purple" height="2.0em" version="1.1" viewbox="0 0 24 24" width="2.0em"><path d="M3 2.75A2.75 2.75 0 015.75 0h14.5a.75.75 0 01.75.75v20.5a.75.75 0 01-.75.75h-6a.75.75 0 010-1.5h5.25v-4H6A1.5 1.5 0 004.5 18v.75c0 .716.43 1.334 1.05 1.605a.75.75 0 01-.6 1.374A3.25 3.25 0 013 18.75v-16zM19.5 1.5V15H6c-.546 0-1.059.146-1.5.401V2.75c0-.69.56-1.25 1.25-1.25H19.5z" fill-rule="evenodd"></path><path d="M7 18.25a.25.25 0 01.25-.25h5a.25.25 0 01.25.25v5.01a.25.25 0 01-.397.201l-2.206-1.604a.25.25 0 00-.294 0L7.397 23.46a.25.25 0 01-.397-.2v-5.01z"></path></svg> Explanation Material</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../references/index.html"><svg aria-hidden="true" class="sd-octicon sd-octicon-tools sd-text-primary" height="2.0em" version="1.1" viewbox="0 0 24 24" width="2.0em"><path d="M7.875 2.292a.125.125 0 00-.032.018A7.24 7.24 0 004.75 8.25a7.247 7.247 0 003.654 6.297c.57.327.982.955.941 1.682v.002l-.317 6.058a.75.75 0 11-1.498-.078l.317-6.062v-.004c.006-.09-.047-.215-.188-.296A8.747 8.747 0 013.25 8.25a8.74 8.74 0 013.732-7.169 1.547 1.547 0 011.709-.064c.484.292.809.835.809 1.46v4.714a.25.25 0 00.119.213l2.25 1.385c.08.05.182.05.262 0l2.25-1.385a.25.25 0 00.119-.213V2.478c0-.626.325-1.169.81-1.461a1.547 1.547 0 011.708.064 8.74 8.74 0 013.732 7.17 8.747 8.747 0 01-4.41 7.598c-.14.081-.193.206-.188.296v.004l.318 6.062a.75.75 0 11-1.498.078l-.317-6.058v-.002c-.041-.727.37-1.355.94-1.682A7.247 7.247 0 0019.25 8.25a7.24 7.24 0 00-3.093-5.94.125.125 0 00-.032-.018l-.01-.001c-.003 0-.014 0-.031.01-.036.022-.084.079-.084.177V7.19a1.75 1.75 0 01-.833 1.49l-2.25 1.385a1.75 1.75 0 01-1.834 0l-2.25-1.384A1.75 1.75 0 018 7.192V2.477c0-.098-.048-.155-.084-.176a.062.062 0 00-.031-.011l-.01.001z" fill-rule="evenodd"></path></svg> Reference Guides</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../references/observing_modes/pulsar_reference.html">Pulsar Observing Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../references/receivers/argus.html">Argus</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../references/receivers/mustang2.html">MUSTANG-2</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../references/receivers/mustang2/mustang2_overview.html">MUSTANG-2 Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../references/receivers/mustang2/mustang2_instrument_team.html">MUSTANG-2 Instrument Team</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../references/receivers/mustang2/mustang2_bandpass.html">MUSTANG-2 Bandpass Information</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../references/receivers/mustang2/mustang2_filtering.html">MUSTANG-2 Filtering</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../references/receivers/mustang2/mustang2_mapping.html">MUSTANG-2 Mapping Information</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../references/receivers/mustang2/mustang2_publications.html">MUSTANG-2 Publications</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../references/receivers/mustang2/mustang2_datasets.html">MUSTANG-2 Published Data Sets</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../references/receivers/mustang2/mustang2_dev.html">MUSTANG-2 Historical Development</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../../references/software/scheduling-blocks.html">Scheduling Block Commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../references/software/gbtidl.html">GBTIDL commands</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/aschmiedeke/gbtdocs" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/aschmiedeke/gbtdocs/issues/new?title=Issue%20on%20page%20%2Fhow-tos/data_reduction/gbtidl.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/how-tos/data_reduction/gbtidl.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>How to process spectra using GBTIDL (examples)</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-on-off">Basic On/Off</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-frequency-switched-fsw">Basic Frequency-Switched (fsw)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-nodding">Basic Nodding</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#advanced-on-off">Advanced On/Off</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rfi-excision-and-baselining">RFI excision and baselining</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#double-gaussian-feature">Double Gaussian feature</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="how-to-process-spectra-using-gbtidl-examples">
<h1>How to process spectra using GBTIDL (examples)<a class="headerlink" href="#how-to-process-spectra-using-gbtidl-examples" title="Link to this heading">#</a></h1>
<p>Below are a series of common data reduction GBTIDL processes with explanations and screenshots mixed in.
To get an in-depth explanation for any gbtidl-specifig procedure or function, you can type “usage” with the procedure/function name and the “/verbose” option:</p>
<div class="highlight-idl notranslate"><div class="highlight"><pre><span></span>usage,<span class="w"> </span>“getps”,<span class="w"> </span><span class="o">/</span>verbose
</pre></div>
</div>
<section id="basic-on-off">
<h2>Basic On/Off<a class="headerlink" href="#basic-on-off" title="Link to this heading">#</a></h2>
<p>Here is an example of a basic data reduction process on an L-band On/Off procedure.</p>
<div class="admonition-data admonition">
<p class="admonition-title">Data</p>
<p>ngc2415.fits</p>
</div>
<p>Load the data into gbtidl.</p>
<div class="highlight-idl notranslate"><div class="highlight"><pre><span></span>filein,<span class="w"> </span><span class="s2">&quot;data/ngc2415.fits&quot;</span>
</pre></div>
</div>
<p>Display a summary of its contents.</p>
<div class="highlight-idl notranslate"><div class="highlight"><pre><span></span>summary
</pre></div>
</div>
<img alt="../../_images/gbtidl_basic-onoff_00-summary.png" src="../../_images/gbtidl_basic-onoff_00-summary.png" />
<p>We can see that this data set has two scans on the galaxy NGC 2415, with one slightly offset in position. The catalog used for this observation says the galaxy has a velocity of 3784 km/s, the rest frequency of the observed line in the first frequency window is 1420 MHz/1.420 GHz, there are 5 frequency windows, 151 integrations, 1 beam/feed, and lastly the azimuth/elevation values of the GBT at the time of the scan.</p>
<p>For a first look at the spectrum, we call the “getps” procedure, which calibrates the On vs. Off scans and averages up all 151 integrations. Without designating the polarization or spectral window, it will default to the first polarization (Linear YY for the L-band receiver) and first spectral window (centered on the redshifted HI line in this case).</p>
<div class="highlight-idl notranslate"><div class="highlight"><pre><span></span>getps,<span class="w"> </span><span class="mi">152</span>
</pre></div>
</div>
<img alt="../../_images/gbtidl_basic-onoff_01-getps.png" src="../../_images/gbtidl_basic-onoff_01-getps.png" />
<p>In order to see anything useful, we may have to smooth the data. This is usually done with the procedures “gsmooth” or “boxcar”, with the latter using a gaussian smoothing kernel and the latter using a flat kernel. The first input “N” is the size of the kernel in channels and the second option keeps only every N-th channel.</p>
<div class="highlight-idl notranslate"><div class="highlight"><pre><span></span>gsmooth,<span class="w"> </span><span class="mi">5</span>,<span class="w"> </span><span class="o">/</span>decimate
</pre></div>
</div>
<img alt="../../_images/gbtidl_basic-onoff_02-gsmooth.png" src="../../_images/gbtidl_basic-onoff_02-gsmooth.png" />
<p>We can convert the data to the same velocity frame specified in the observing configuration with “setxunit”. By default this will apply a doppler correction. This can also be done by selecting “km/s” in the GUI - the fourth dropdown menu from the left.</p>
<div class="highlight-idl notranslate"><div class="highlight"><pre><span></span>setxunit,<span class="w"> </span><span class="s2">&quot;km/s&quot;</span>
</pre></div>
</div>
<p>We may learn that the TCAL value in the database is out of date, and the signals are too weak by a factor of 1.2. “scale” removes this systematic offset.</p>
<div class="highlight-idl notranslate"><div class="highlight"><pre><span></span>scale,<span class="w"> </span><span class="mf">1.2</span>
</pre></div>
</div>
<img alt="../../_images/gbtidl_basic-onoff_03-scaled.png" src="../../_images/gbtidl_basic-onoff_03-scaled.png" />
<p>Now we may want to save these results for posterity or further analysis. You can also use “write_csv” to make a csv file instead of an ascii-columned text file, or “write_ps” to output a “publication-quality” postscript image of the spectrum.</p>
<p>write_ascii,”NGC2415_HI.ascii”</p>
<p>gbtidl also allows for multi-line input and loops in the same line. We can use this to quickly check the other spectral windows. The line breaks are made with the “&amp;” character. First, let’s freeze the plotter so it doesn’t auto-update after each loop:</p>
<div class="highlight-idl notranslate"><div class="highlight"><pre><span></span>freeze
</pre></div>
</div>
<p>And change the x-axis back to frequency so that each spectral window is plotted correctly.</p>
<div class="highlight-idl notranslate"><div class="highlight"><pre><span></span>setxunit,<span class="s2">&quot;GHz&quot;</span>
</pre></div>
</div>
<p>Now finally type in the loop:</p>
<div class="highlight-idl notranslate"><div class="highlight"><pre><span></span><span class="k">for</span><span class="w"> </span>k<span class="o">=</span><span class="mi">1</span>,<span class="mi">4</span>,<span class="mi">1</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="k">begin</span><span class="w"> </span>&amp;<span class="w"> </span>getps,<span class="mi">152</span>,ifnum<span class="o">=</span>k<span class="w"> </span>&amp;<span class="w"> </span>gsmooth,<span class="mi">5</span>,<span class="o">/</span>decimate<span class="w"> </span>&amp;<span class="w"> </span>scale,<span class="mf">1.2</span><span class="w"> </span>&amp;<span class="w"> </span>oshow<span class="w"> </span>&amp;<span class="w"> </span><span class="k">endfor</span>
</pre></div>
</div>
<p>Note that the third and fourth spectral windows overlap significantly. We’re not going to save these spectra. We can zoom into the OH line:</p>
<div class="highlight-idl notranslate"><div class="highlight"><pre><span></span>setxy,<span class="mf">1.64</span>,<span class="mf">1.66</span>,<span class="o">-</span><span class="mf">0.5</span>,<span class="mi">1</span>
</pre></div>
</div>
<img alt="../../_images/gbtidl_basic-onoff_04-loop.png" src="../../_images/gbtidl_basic-onoff_04-loop.png" />
<p>And it doesn’t look like there is anything there.</p>
</section>
<section id="basic-frequency-switched-fsw">
<h2>Basic Frequency-Switched (fsw)<a class="headerlink" href="#basic-frequency-switched-fsw" title="Link to this heading">#</a></h2>
<p>Here is an example of a basic data reduction process on a nearby ammonia cloud.</p>
<div class="admonition-data admonition">
<p class="admonition-title">Data</p>
<p>TGBT22A_503_02.raw.vegas</p>
</div>
<p>Load in the data. This is a directory, so either “dirin” or “filein” will work.</p>
<div class="highlight-idl notranslate"><div class="highlight"><pre><span></span>filein,<span class="w"> </span><span class="s2">&quot;data/TGBT22A_503_02.raw.vegas&quot;</span>
summary
</pre></div>
</div>
<p>In here, there is one frequency-switched scan (#64), and two nodding scans (#62 and #63). For the KFPA, which is 7 beams arranged in a hexagon, the <code class="xref py py-func docutils literal notranslate"><span class="pre">Track()</span></code> command will use the central beam by default, so fdnum=0. The frequency-switched scan is calibrated with</p>
<div class="highlight-idl notranslate"><div class="highlight"><pre><span></span>getfs,<span class="mi">64</span>,fdnum<span class="o">=</span><span class="mi">0</span>
</pre></div>
</div>
<img alt="../../_images/gbtidl_basic-fsw_00-getfs.png" src="../../_images/gbtidl_basic-fsw_00-getfs.png" />
<p>It looks like there is a small detection at around 23.698 GHz. We can smooth the spectrum to see a little more clearly.</p>
<div class="highlight-idl notranslate"><div class="highlight"><pre><span></span>gsmooth,<span class="mi">5</span>,<span class="o">/</span>decimate
</pre></div>
</div>
<p>There is a very nice detection of ammonia! Let’s average the two polarizations to reduce the noise even further. First, put the current spectrum in the primary accumulation buffer;</p>
<div class="highlight-idl notranslate"><div class="highlight"><pre><span></span>accum
</pre></div>
</div>
<p>And load the other polarization, smooth it to the same frequency resolution, and add it to the primary accumulation buffer. You can press the up arrow in GBTIDL for an input history.</p>
<div class="highlight-idl notranslate"><div class="highlight"><pre><span></span>getfs,<span class="mi">64</span>,fdnum<span class="o">=</span><span class="mi">0</span>,<span class="w"> </span>plnum<span class="o">=</span><span class="mi">1</span>
gsmooth,<span class="mi">5</span>,<span class="o">/</span>decimate
accum
</pre></div>
</div>
<p>Now we average the two spectra in the accumulation buffer together, which will automatically drop the result in the primary data container.</p>
<div class="highlight-idl notranslate"><div class="highlight"><pre><span></span>ave
</pre></div>
</div>
<img alt="../../_images/gbtidl_basic-fsw_01-gsmooth.png" src="../../_images/gbtidl_basic-fsw_01-gsmooth.png" />
<p>We can output this spectrum to an sdfits file with the “keep” procedure. We have to set a filename first.</p>
<div class="highlight-idl notranslate"><div class="highlight"><pre><span></span>fileout,<span class="w"> </span>“W3_1_NH3.fits”
keep
</pre></div>
</div>
<p>To compare with the nodding scans in the next example, we can save this to the next data container in GBTIDL.</p>
<div class="highlight-idl notranslate"><div class="highlight"><pre><span></span>copy,<span class="mi">0</span>,<span class="mi">1</span>
</pre></div>
</div>
</section>
<section id="basic-nodding">
<h2>Basic Nodding<a class="headerlink" href="#basic-nodding" title="Link to this heading">#</a></h2>
<p>Here is an example of a basic data reduction process on a nearby ammonia cloud, from a nodding scan.</p>
<div class="admonition-data admonition">
<p class="admonition-title">Data</p>
<p>TGBT22A_503_02.raw.vegas</p>
</div>
<p>Nodding scans are only done with multibeam receivers on the GBT. They are performed by tracking the source with one beam for a certain amount of time, then moving the whole telescope in azimuth/elevation so that a different beam tracks the source for the same amount of time. It effectively functions like a double On/Off scan. The same data file we used above has two nodding scans on the same ammonia cloud.</p>
<div class="highlight-idl notranslate"><div class="highlight"><pre><span></span>filein,<span class="w"> </span><span class="s2">&quot;data/TGBT22A_503_02.raw.vegas&quot;</span>
</pre></div>
</div>
<p>Normally, nodding scans are calibrated with “getnod”, which is currently broken for KFPA data. We can use “getsigref” instead, which functions almost identically. We just have to define the signal and reference scans for each beam. For this data, the nodding was between beams 3 and 7, which correspond to fdnum values of 2 and 6. First, “sclear” makes sure the accumulation buffer from the previous example is cleared.</p>
<div class="highlight-idl notranslate"><div class="highlight"><pre><span></span>sclear
</pre></div>
</div>
<p>Beam 3 was on source in scan 62 (the “signal” scan) and offset in scan 63 (the “reference” scan).</p>
<div class="highlight-idl notranslate"><div class="highlight"><pre><span></span>getsigref,<span class="w"> </span><span class="mi">62</span>,<span class="w"> </span><span class="mi">63</span>,<span class="w"> </span>fdnum<span class="o">=</span><span class="mi">2</span>
gsmooth,<span class="w"> </span><span class="mi">5</span>,<span class="w"> </span><span class="o">/</span>decimate
</pre></div>
</div>
<img alt="../../_images/gbtidl_basic-nod_00-gsmooth.png" src="../../_images/gbtidl_basic-nod_00-gsmooth.png" />
<div class="highlight-idl notranslate"><div class="highlight"><pre><span></span>accum
</pre></div>
</div>
<p>Beam 7 was also part of the nod, but was offset in the opposite way. So, scan 63 is now the signal scan, and 62 is the reference scan.</p>
<div class="highlight-idl notranslate"><div class="highlight"><pre><span></span>getsigref,<span class="w"> </span><span class="mi">63</span>,<span class="w"> </span><span class="mi">62</span>,<span class="w"> </span>fdnum<span class="o">=</span><span class="mi">6</span>
gsmooth,<span class="w"> </span><span class="mi">5</span>,<span class="w"> </span><span class="o">/</span>decimate
accum
ave
</pre></div>
</div>
<img alt="../../_images/gbtidl_basic-nod_01-getsigref.png" src="../../_images/gbtidl_basic-nod_01-getsigref.png" />
<p>The continuum is slightly offset from 0, so we can use the baseline feature to subtract that out. “setregion” sets the areas the fitting procedure uses, and this can be done either on the GUI with the left/right mouse buttons or by designating a series of start/stop points in channel number from the command line input. The regions in this case should be everything except for the rolloff at the edges of the band and around the signal itself.</p>
<div class="highlight-idl notranslate"><div class="highlight"><pre><span></span>setregion
</pre></div>
</div>
<img alt="../../_images/gbtidl_basic-nod_02-setregion.png" src="../../_images/gbtidl_basic-nod_02-setregion.png" />
<p>“baseline” by default uses a 0th order polynomial - a flat line - to fit. The continuum is already pretty flat, so this is all that’s needed.</p>
<div class="highlight-idl notranslate"><div class="highlight"><pre><span></span>baseline
</pre></div>
</div>
<p>Now the spectrum’s baseline should be centered about Ta = 0 Kelvin. Next, to compare with the frequency-switched data, we use “oshow” with the number of the data container we saved to.</p>
<div class="highlight-idl notranslate"><div class="highlight"><pre><span></span>oshow,<span class="mi">1</span>
</pre></div>
</div>
<img alt="../../_images/gbtidl_basic-nod_03-baseline.png" src="../../_images/gbtidl_basic-nod_03-baseline.png" />
</section>
<section id="advanced-on-off">
<h2>Advanced On/Off<a class="headerlink" href="#advanced-on-off" title="Link to this heading">#</a></h2>
<section id="rfi-excision-and-baselining">
<h3>RFI excision and baselining<a class="headerlink" href="#rfi-excision-and-baselining" title="Link to this heading">#</a></h3>
<div class="admonition-data admonition">
<p class="admonition-title">Data</p>
<p>AGBT17A_404_01.raw.vegas</p>
</div>
<p>Load in the data:</p>
<div class="highlight-idl notranslate"><div class="highlight"><pre><span></span>filein,<span class="w"> </span>“data<span class="o">/</span>AGBT17A_404_01.raw.vegas”
</pre></div>
</div>
<p>You can see there are two sets of position-switched L-band scans here. We will start with the latter two and see if we can find an HI detection:</p>
<div class="highlight-idl notranslate"><div class="highlight"><pre><span></span>getps,<span class="mi">19</span>
zline
</pre></div>
</div>
<img alt="../../_images/gbtidl_advanced-onoff_00-getps.png" src="../../_images/gbtidl_advanced-onoff_00-getps.png" />
<p>“zline” will help with modelling the baseline later. We can see there is a huge GPS-L3 RFI signal flooding out the left side of the band. We can step through one integration at a time (there are 60 total plus one blanked integration) to see how bad/pervasive the GPS is.</p>
<div class="highlight-idl notranslate"><div class="highlight"><pre><span></span><span class="k">for</span><span class="w"> </span>i<span class="o">=</span><span class="mi">0</span>,<span class="mi">61</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="k">begin</span><span class="w"> </span>&amp;<span class="w"> </span>getps,<span class="w"> </span><span class="mi">19</span>,<span class="w"> </span>intnum<span class="o">=</span>i,<span class="w"> </span>plnum<span class="o">=</span><span class="mi">0</span><span class="w"> </span>&amp;<span class="w"> </span><span class="k">end</span>
</pre></div>
</div>
<p>This will step through all 60 integrations as fast as your computer can calibrate and plot them. If you want to see it a little slower, you can add a wait statement:</p>
<div class="highlight-idl notranslate"><div class="highlight"><pre><span></span><span class="k">for</span><span class="w"> </span>i<span class="o">=</span><span class="mi">0</span>,<span class="mi">61</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="k">begin</span><span class="w"> </span>&amp;<span class="w"> </span>getps,<span class="w"> </span><span class="mi">19</span>,<span class="w"> </span>intnum<span class="o">=</span>i,<span class="w"> </span>plnum<span class="o">=</span><span class="mi">0</span><span class="w"> </span>&amp;<span class="w"> </span><span class="nb">wait</span>,<span class="w"> </span><span class="mf">0.3</span><span class="w"> </span>&amp;<span class="w"> </span><span class="k">end</span>
</pre></div>
</div>
<p>From this, we can see there is only a portion in the latter half of the OFF scan that is blocked by RFI. Stepping through the integrations manually, we can see the trouble starts in integration #43 and ends at integration #51.</p>
<div class="highlight-idl notranslate"><div class="highlight"><pre><span></span>getps,<span class="mi">19</span>,<span class="w"> </span>intnum<span class="o">=</span><span class="mi">42</span>
getps,<span class="mi">19</span>,<span class="w"> </span>intnum<span class="o">=</span><span class="mi">43</span>
getps,<span class="mi">19</span>,<span class="w"> </span>intnum<span class="o">=</span><span class="mi">51</span>
getps,<span class="mi">19</span>,<span class="w"> </span>intnum<span class="o">=</span><span class="mi">52</span>
</pre></div>
</div>
<img alt="../../_images/gbtidl_advanced-onoff_01-intnums.png" src="../../_images/gbtidl_advanced-onoff_01-intnums.png" />
<p>So let’s accumulate all the clean integrations for both polarizations, and see if there’s any HI detection. Keep in mind the IDL for loops are inclusive on both ends.</p>
<div class="highlight-idl notranslate"><div class="highlight"><pre><span></span>sclear
<span class="k">for</span><span class="w"> </span>i<span class="o">=</span><span class="mi">0</span>,<span class="mi">42</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="k">begin</span><span class="w"> </span>&amp;<span class="w"> </span>getps,<span class="w"> </span><span class="mi">19</span>,<span class="w"> </span>intnum<span class="o">=</span>i,<span class="w"> </span>plnum<span class="o">=</span><span class="mi">0</span><span class="w"> </span>&amp;<span class="w"> </span>accum<span class="w"> </span>&amp;<span class="w"> </span><span class="k">end</span>
<span class="k">for</span><span class="w"> </span>i<span class="o">=</span><span class="mi">0</span>,<span class="mi">42</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="k">begin</span><span class="w"> </span>&amp;<span class="w"> </span>getps,<span class="w"> </span><span class="mi">19</span>,<span class="w"> </span>intnum<span class="o">=</span>i,<span class="w"> </span>plnum<span class="o">=</span><span class="mi">1</span><span class="w"> </span>&amp;<span class="w"> </span>accum<span class="w"> </span>&amp;<span class="w"> </span><span class="k">end</span>
<span class="k">for</span><span class="w"> </span>i<span class="o">=</span><span class="mi">52</span>,<span class="mi">60</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="k">begin</span><span class="w"> </span>&amp;<span class="w"> </span>getps,<span class="w"> </span><span class="mi">19</span>,<span class="w"> </span>intnum<span class="o">=</span>i,<span class="w"> </span>plnum<span class="o">=</span><span class="mi">0</span><span class="w"> </span>&amp;<span class="w"> </span>accum<span class="w"> </span>&amp;<span class="w"> </span><span class="k">end</span>
<span class="k">for</span><span class="w"> </span>i<span class="o">=</span><span class="mi">52</span>,<span class="mi">60</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="k">begin</span><span class="w"> </span>&amp;<span class="w"> </span>getps,<span class="w"> </span><span class="mi">19</span>,<span class="w"> </span>intnum<span class="o">=</span>i,<span class="w"> </span>plnum<span class="o">=</span><span class="mi">1</span><span class="w"> </span>&amp;<span class="w"> </span>accum<span class="w"> </span>&amp;<span class="w"> </span><span class="k">end</span>
ave
</pre></div>
</div>
<img alt="../../_images/gbtidl_advanced-onoff_02-accum.png" src="../../_images/gbtidl_advanced-onoff_02-accum.png" />
<p>Smooth is:</p>
<div class="highlight-idl notranslate"><div class="highlight"><pre><span></span>boxcar,<span class="w"> </span><span class="mi">5</span>,<span class="w"> </span><span class="o">/</span>decimate
</pre></div>
</div>
<img alt="../../_images/gbtidl_advanced-onoff_03-boxcar.png" src="../../_images/gbtidl_advanced-onoff_03-boxcar.png" />
<p>There may be a small detection at 1389.5 MHz. Let’s try to fit a baseline - we may have to fit either a 2nd or 3rd order polynomial. First, we will set a checkpoint here by copying the current spectrum to the second data container so we can go back to this step. Then, setregion to everything but the bandpass edges and the possible signal in the middle:</p>
<div class="highlight-idl notranslate"><div class="highlight"><pre><span></span>copy,<span class="w"> </span><span class="mi">0</span>,<span class="w"> </span><span class="mi">1</span>
setregion
</pre></div>
</div>
<img alt="../../_images/gbtidl_advanced-onoff_04-setregion.png" src="../../_images/gbtidl_advanced-onoff_04-setregion.png" />
<p>We can trial baseline fits with the “bshape” procedure.</p>
<div class="highlight-idl notranslate"><div class="highlight"><pre><span></span>bshape,<span class="w"> </span>nfit<span class="o">=</span><span class="mi">2</span>
bshape,<span class="w"> </span>nfit<span class="o">=</span><span class="mi">3</span>,<span class="w"> </span>color<span class="o">=</span>!green
</pre></div>
</div>
<img alt="../../_images/gbtidl_advanced-onoff_05-bshape.png" src="../../_images/gbtidl_advanced-onoff_05-bshape.png" />
<p>The 3rd order fit (green) looks much better than the 2nd order fit (white). Next, the “bsubtract” procedure applies the last fit computed and subtracts it from the data - in this case, our 3rd order fit.</p>
<div class="highlight-idl notranslate"><div class="highlight"><pre><span></span>bsubtract
sety,<span class="w"> </span><span class="o">-</span><span class="mf">0.05</span>,<span class="w"> </span><span class="mf">0.08</span>
</pre></div>
</div>
<img alt="../../_images/gbtidl_advanced-onoff_06-bsubtract.png" src="../../_images/gbtidl_advanced-onoff_06-bsubtract.png" />
<p>There may be a tiny detection, but the baseline fit is not the best, particularly noticeable in the 1384 - 1389 MHz range. We might go back and see if we can apply a more strict fit, setting the region to be closer in to our possible detection and avoiding more of the bandpass edge.</p>
<div class="highlight-idl notranslate"><div class="highlight"><pre><span></span>copy,<span class="mi">1</span>,<span class="mi">0</span>
setregion<span class="w">                       </span>;<span class="w"> </span>see<span class="w"> </span><span class="nb">image</span><span class="w"> </span>below<span class="w"> </span><span class="k">for</span><span class="w"> </span>the<span class="w"> </span>range<span class="w"> </span>I<span class="w"> </span>chose
bshape,<span class="w"> </span>nfit<span class="o">=</span><span class="mi">3</span>
bshape,<span class="w"> </span>nfit<span class="o">=</span><span class="mi">4</span>,<span class="w"> </span>color<span class="o">=</span>!green
</pre></div>
</div>
<img alt="../../_images/gbtidl_advanced-onoff_07-setregion.png" src="../../_images/gbtidl_advanced-onoff_07-setregion.png" />
<p>The fourth order fit looks to follow that hump at 1385 MHz a little better, so we might pick that despite the large divergence towards the edges of the band.</p>
<div class="highlight-idl notranslate"><div class="highlight"><pre><span></span>bsubtract
setxy,<span class="w"> </span><span class="mi">1382</span>,<span class="mi">1397</span>,<span class="o">-</span><span class="mf">0.05</span>,<span class="mf">0.08</span>
</pre></div>
</div>
<img alt="../../_images/gbtidl_advanced-onoff_08-bsubtract.png" src="../../_images/gbtidl_advanced-onoff_08-bsubtract.png" />
<p>The possible signal looks slightly more significant, but maybe not quite enough to warrant a detection.</p>
</section>
<section id="double-gaussian-feature">
<h3>Double Gaussian feature<a class="headerlink" href="#double-gaussian-feature" title="Link to this heading">#</a></h3>
<p>Now let’s turn our attention to scan 15. First, accumulate both polarizations together.</p>
<div class="highlight-idl notranslate"><div class="highlight"><pre><span></span>sclear
getps,<span class="mi">15</span>
accum
getps,<span class="mi">15</span>,<span class="w"> </span>plnum<span class="o">=</span><span class="mi">1</span>
accum
ave
boxcar,<span class="w"> </span><span class="mi">5</span>,<span class="w"> </span><span class="o">/</span>decimate
</pre></div>
</div>
<img alt="../../_images/gbtidl_advanced-onoff_09-spectralLine.png" src="../../_images/gbtidl_advanced-onoff_09-spectralLine.png" />
<p>It does look like there is some GPS-L3 interference on the left side again, we can ignore that since it is far away. Let’s grab some info about the spectrum and switch to velocity units.</p>
<div class="highlight-idl notranslate"><div class="highlight"><pre><span></span>header
</pre></div>
</div>
<img alt="../../_images/gbtidl_advanced-onoff_10-header.png" src="../../_images/gbtidl_advanced-onoff_10-header.png" />
<p>The sky frequency, <span class="math notranslate nohighlight">\(\nu_\text{sky}\)</span>, is 1395 MHz and the smoothed frequency resolution, <span class="math notranslate nohighlight">\(d\nu\)</span>, is 28.61 kHz, which corresponds to a velocity resolution, <span class="math notranslate nohighlight">\(dv\)</span>, of 6.15 km/s.</p>
<p><span class="math notranslate nohighlight">\(dv = c * \frac{(\nu_\text{sky} - (\nu_\text{sky}-d\nu)}{(\nu_\text{sky} - d\nu)}\)</span></p>
<p>There seems to be a slight downward curve in the baseline, so I will fit a 2nd order baseline.</p>
<div class="highlight-idl notranslate"><div class="highlight"><pre><span></span>velo
setregion
bshape,<span class="w"> </span>nfit<span class="o">=</span><span class="mi">2</span>
</pre></div>
</div>
<img alt="../../_images/gbtidl_advanced-onoff_11-setregion.png" src="../../_images/gbtidl_advanced-onoff_11-setregion.png" />
<div class="highlight-idl notranslate"><div class="highlight"><pre><span></span>bsubtract
sety,<span class="w"> </span><span class="o">-</span><span class="mf">0.05</span>,<span class="w"> </span><span class="mf">0.08</span>
</pre></div>
</div>
<p>Now we will fit two gaussians to this detection. Since this is a rotating HI galaxy, the actual model should be a two-horn profile, but two gaussians should be enough to fit this. GBTIDL does not have a native two-horn profile fitting procedure.</p>
<div class="highlight-idl notranslate"><div class="highlight"><pre><span></span>setx,<span class="mi">4000</span>,<span class="mi">6500</span>
fitgauss,modelbuffer<span class="o">=</span><span class="mi">2</span>
</pre></div>
</div>
<p>The program will tell you what to do, but the process involves left clicking the boundaries of the signal, then giving it guesses to model with the middle mouse button. In the zoomed in image below, I left click at the white X marks on either side, then use the middle mouse button to click at the top of the signal, then the half-power point in the order shown:</p>
<img alt="../../_images/gbtidl_advanced-onoff_12-fitgauss.png" src="../../_images/gbtidl_advanced-onoff_12-fitgauss.png" />
<p>And finally, a right click tells GBTIDL to model the Gaussian:</p>
<img alt="../../_images/gbtidl_advanced-onoff_13-fitgauss.png" src="../../_images/gbtidl_advanced-onoff_13-fitgauss.png" />
<img alt="../../_images/gbtidl_advanced-onoff_14-fitgauss.png" src="../../_images/gbtidl_advanced-onoff_14-fitgauss.png" />
<p>We’ll copy the original spectrum to data container 4, then subtract this gaussian out so we can model the other one.</p>
<div class="highlight-idl notranslate"><div class="highlight"><pre><span></span>copy,<span class="mi">0</span>,<span class="mi">4</span>
subtract,<span class="w"> </span><span class="mi">4</span>,<span class="w"> </span><span class="mi">2</span>,<span class="w"> </span><span class="mi">0</span>
</pre></div>
</div>
<p>So now the primary data container has the results of DC4 - DC2.</p>
<img alt="../../_images/gbtidl_advanced-onoff_15-subtract.png" src="../../_images/gbtidl_advanced-onoff_15-subtract.png" />
<p>Fit the other Gaussian:</p>
<div class="highlight-idl notranslate"><div class="highlight"><pre><span></span>fitgauss,<span class="w"> </span>modelbuffer<span class="o">=</span><span class="mi">3</span>
</pre></div>
</div>
<img alt="../../_images/gbtidl_advanced-onoff_16-fitgauss.png" src="../../_images/gbtidl_advanced-onoff_16-fitgauss.png" />
<img alt="../../_images/gbtidl_advanced-onoff_17-fitgauss.png" src="../../_images/gbtidl_advanced-onoff_17-fitgauss.png" />
<p>And then show the original spectrum with the two models overlaid:</p>
<div class="highlight-idl notranslate"><div class="highlight"><pre><span></span>copy,<span class="w"> </span><span class="mi">4</span>,<span class="w"> </span><span class="mi">0</span>
add,<span class="w"> </span><span class="mi">2</span>,<span class="w"> </span><span class="mi">3</span>,<span class="w"> </span><span class="mi">5</span>
oshow,<span class="w"> </span><span class="mi">5</span>
</pre></div>
</div>
<img alt="../../_images/gbtidl_advanced-onoff_18-fitgaussResult.png" src="../../_images/gbtidl_advanced-onoff_18-fitgaussResult.png" />
</section>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../receivers/mustang2/data/mustang2_deliverables.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">MUSTANG-2 Deliverables</p>
      </div>
    </a>
    <a class="right-next"
       href="calculate_opacity.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">How to account for sky opacity in GBT Observations</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-on-off">Basic On/Off</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-frequency-switched-fsw">Basic Frequency-Switched (fsw)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-nodding">Basic Nodding</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#advanced-on-off">Advanced On/Off</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rfi-excision-and-baselining">RFI excision and baselining</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#double-gaussian-feature">Double Gaussian feature</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Green Bank Observatory
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023-24, Green Bank Observatory, A. Schmiedeke.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>